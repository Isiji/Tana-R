{% extends 'layout.html' %}

{% block content %}
<div class="container mt-5">
    <h2>Select Polling Station</h2>
    <div class="form-group">
        <label for="pollingStation">Polling Station</label>
        <select id="pollingStation" class="form-control" onchange="fetchDetails()">
            <option value="">Select a Polling Station</option>
            {% for station in polling_stations %}
                <option value="{{ station.id }}">{{ station.name }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="form-group">
        <label for="ward">Ward</label>
        <input type="text" id="ward" class="form-control" readonly>
    </div>
    <div class="form-group">
        <label for="constituency">Constituency</label>
        <input type="text" id="constituency" class="form-control" readonly>
    </div>
</div>

<script>
    async function fetchDetails() {
        const pollingStationId = document.getElementById('pollingStation').value;
        if (pollingStationId) {
            const response = await fetch(`{{ url_for('representation.get_polling_station_details', polling_station_id=0) }}`.replace('0', pollingStationId));
            const data = await response.json();
            if (data.error) {
                document.getElementById('ward').value = '';
                document.getElementById('constituency').value = '';
                alert(data.error);
            } else {
                document.getElementById('ward').value = data.ward;
                document.getElementById('constituency').value = data.constituency;
            }
        } else {
            document.getElementById('ward').value = '';
            document.getElementById('constituency').value = '';
        }
    }
</script>
{% endblock %}
